@startuml attacks
!option handwritten true
skinparam backgroundColor transparent
skinparam rectangle {
  BorderColor #333333
  FontColor #333333
  FontSize 14
}
skinparam note {
  BackgroundColor #FFFFCC
  BorderColor #333333
}

title Bowtie Risk Diagram - Confidential Compute Impact

left to right direction

' === Grouped Sections ===
package "Threats" #FFDDDD {
  rectangle "Human Error" as C1
  rectangle "Technical Failure" as C2
  rectangle "External Attack" as C3
}

package "Risk Event" #FFD700 {
  rectangle "Resource Hijacking" as R
  note right of R
    **Impact:** High
    **Likelihood:** Medium
  end note
  rectangle "Data Breach" as R
  note right of R
    **Impact:** High
    **Likelihood:** Medium
  end note
}

package "Consequences" #FFAAAA {
  rectangle "Financial Loss" as Co1
  rectangle "Reputation Damage" as Co2
  rectangle "Legal Penalties" as Co3
}

package "Preventive Controls" #DDFFDD {
  rectangle "System Monitoring (Enhanced by Confidential Compute)" as P2
  rectangle "Confidential Compute" as CC
}

package "Mitigative Controls" #DDDDFF {
  rectangle "Incident Response" as M1
  rectangle "Cyber Insurance" as M2
}

' === Connections ===
C1 -[#FF0000]-> R
C2 -[#FF0000]-> R
C3 -[#FF0000]-> R

R -[#FF0000]-> Co1
R -[#FF0000]-> Co2
R -[#FF0000]-> Co3

' Confidential Compute replaces Access Control and strengthens monitoring
CC ..[#008000].. C3 : Neutralizes External Attack
P2 ..[#008000].. C2 : Detects Technical Failures

M1 ..[#0000FF].. Co1 : Mitigative
M2 ..[#0000FF].. Co3 : Mitigative

@enduml