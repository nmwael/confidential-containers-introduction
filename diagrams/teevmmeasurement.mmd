
flowchart TB
  subgraph TEE["TEE VM measurements"]
    direction TB

    subgraph Build["Build-time / image"]
      TDVF["MRTD / Launch Digest (virtual firmware)"]
      RootFS["Rootfs / OS image hash"]
    end

    subgraph Runtime["Runtime boot"]
      R0["RTMR[0] firmware data (ACPI/CFV)"]
      R1["RTMR[1] kernel"]
      R2["RTMR[2] initrd + cmdline"]
      R3["RTMR[3] runtime/app/config"]
    end

    subgraph Platform["Platform / TCB & identity"]
      TCB["TEE/Platform TCB"]
      End["Endorsements (Intel DCAP / AMD VCEK)"]
      Pol["Launch / guest policy"]
      IDs["ID key digests"]
    end

    subgraph Evidence["Attestation evidence"]
      HW["TDX TDREPORT / SNP REPORT"]
      Quote["Signed quote"]
      PCRs["vTPM PCRs (measured boot)"]
      UEFI["UEFI event log (PCRs 0â€“7)"]
      RD["REPORTDATA binding"]
    end
  end
